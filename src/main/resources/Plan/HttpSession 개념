/*
[HttpSession 개념 정리]
- 목적: 서버가 사용자를 구분해서 "상태를 기억"하기 위한 객체
- 전제: HTTP는 기본적으로 무상태(stateless) 프로토콜
        요청 하나가 끝나면 서버는 사용자를 기억하지 않는다
        → 로그인 기능은 HTTP만으로는 구현 불가능
*/

/*
1. HttpSession이 왜 필요한가
- 로그인 요청에서 아이디/비밀번호 검증을 통과해도
  다음 요청이 들어오면 서버는 "같은 사용자"인지 알 수 없음
- 이 문제를 해결하기 위해
  서버가 사용자별 상태를 저장해야 하고
  그 저장소 역할을 하는 것이 HttpSession
*/

/*
2. HttpSession의 정체
- 서버 메모리에 존재하는 사용자 전용 저장 공간
- 사용자 1명당 세션 1개 생성
- 내부 구조는 Map과 유사
  key   : String
  value : Object

- 개념 예시
  session {
      "LOGIN_MEMBER" : MemberDTO
      "cart"         : CartDTO
  }
*/

/*
3. 세션과 쿠키의 관계 (중요)
- 서버는 세션만 만들어두면 어떤 사용자의 요청인지 알 수 없음
- 이를 위해 세션 ID를 쿠키에 담아 브라우저에 전달

- 흐름
  1) 서버가 세션 생성
  2) 세션 고유 ID(JSESSIONID) 생성
  3) JSESSIONID를 쿠키에 담아 응답
  4) 브라우저는 이후 요청마다 쿠키를 자동 전송
  5) 서버는 JSESSIONID로 세션을 식별

- 핵심
  - 로그인 정보는 쿠키에 저장하지 않음
  - 쿠키에는 세션 번호만 존재
  - 실제 로그인 정보는 서버 세션에만 저장
*/

/*
4. HttpSession 저장 위치
- 기본 설정 기준: 서버 메모리(RAM)

- 의미
  - 서버 재시작 시 세션 전부 소멸
  - 서버가 여러 대일 경우 세션 공유 문제 발생
    (추후 Redis / Spring Security로 해결)
*/

/*
5. HttpSession 생명주기
- 생성
  - 최초 요청에서 세션을 요청할 때 생성
    (컨트롤러 파라미터로 HttpSession을 받을 때 포함)

- 유지
  - 브라우저가 JSESSIONID 쿠키를 유지하는 동안

- 만료
  - session.invalidate() 호출
  - 일정 시간 요청이 없을 때(timeout)
*/

/*
6. 로그인에서 HttpSession의 역할
- 로그인 성공 시
  - 서버가 해당 사용자를 인증된 상태로 기억해야 함
  - HttpSession에 로그인 정보 저장

- 이후 모든 요청에서
  - session에 LOGIN_MEMBER 존재 → 로그인 상태
  - 없으면 → 비로그인 상태

- 즉, HttpSession은
  서버가 로그인 상태를 기억하는 핵심 수단
*/

/*
7. HttpSession을 사용하지 않으면
- 매 요청마다 아이디/비밀번호를 다시 전달해야 함
- 웹 게시판 구조에서는 현실적으로 불가능
*/

/*
8. 현재 프로젝트에서 HttpSession을 사용하는 이유
- Spring Security 이전 단계
- 구조 단순
- 기존 Controller / Service / Mapper 구조와 자연스럽게 결합
- 이후 Spring Security로 전환해도 개념은 그대로 유지
*/

/*
9. 핵심 요약
- HttpSession = 서버가 사용자 상태(로그인)를 기억하는 공간
- 로그인 여부 판단 기준
  session.getAttribute("LOGIN_MEMBER") != null
*/
