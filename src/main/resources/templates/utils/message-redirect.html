<!DOCTYPE html>
<html lang="ko" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org">
<head th:replace="board/fragments/header :: main-head"></head>
<body>
<!--
form태그: 컨트롤러에서 전달받은 네 개의 파라미터 중 params가 비어있지 않으면,
Map에 담겨있는 데이터의 개수만큼 hidden 타입의 <input> 태그를 추가 생성
action 속성에는 리다이렉트 할 URI를 지정하고, method 속성에는 HTTP 요청 메서드를 지정 -->
<form name="dataForm" style="display: none;" th:action="${redirectUri}" th:if="${not #maps.isEmpty(params)}"
      th:method="${method}">
    <input th:each="key, status : ${params.keySet()}" th:name="${key}" th:value="${params.get(key)}" type="hidden"/>
</form>

<script th:src="@{/scripts/common.js}"></script>
<!-- JavsScript:
1. 컨트롤러에서 전달받은 메시지가 비어있지 않으면, 사용자에게 Alert 메시지를 출력
2. 파라미터의 존재 여부에 따라 폼을 서브밋 할지, 단순히 페이지만 이동할지를 판단
→ if (isEmpty(params) == false): params가 비어있지 않으면 폼을 컨트롤러로 서브밋
→ } else { : params가 비어있으면, redirectUri에 지정된 URI를 호출-->
<th:block layout:fragment="script">
    <script th:inline="javascript">
        /*<![CDATA[*/
        window.onload = function () {
            var message = /*[[${message}]]*/ null;
            if (isEmpty(message) == false) {
                alert(message);
            }

            var params = /*[[${params}]]*/ null;
            if (isEmpty(params) == false) {
                document.dataForm.submit();
            } else {
                var redirectUri = /*[[${redirectUri}]]*/ null;
                location.href = redirectUri;
            }
        }
        /*]]>*/
    </script>
</th:block>
</body>
</html>